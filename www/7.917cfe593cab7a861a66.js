(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{Dwri:function(t,e,n){"use strict";n.d(e,"a",(function(){return x}));var r=n("mrSG"),i=n("uFMf"),o=n("xGJU"),a=n("fXoL"),c=n("TEn/"),s=n("HYNq"),l=n("ohih"),u=n("bANG"),b=n("3Pt+"),p=n("ofXK");function f(t,e){1&t&&(a.Kb(0,"div",9),a.Ib(1,"ion-spinner",0),a.Jb())}function h(t,e){1&t&&a.Ib(0,"ion-icon",17)}function d(t,e){1&t&&a.Ib(0,"ion-icon",18)}function m(t,e){if(1&t&&(a.Kb(0,"p"),a.pc(1),a.Jb()),2&t){var n=a.Wb().$implicit;a.xb(1),a.rc(" Created by ",n.layer.profile.name," ")}}function g(t,e){if(1&t){var n=a.Lb();a.Kb(0,"ion-icon",19),a.Sb("click",(function(t){a.ic(n);var e=a.Wb().$implicit;return a.Wb(2).togglePlacemarkVisibility(e,t)})),a.Jb()}if(2&t){var r=a.Wb().$implicit;a.Zb("name",r.visible?"eye":"eye-off")}}function v(t,e){if(1&t){var n=a.Lb();a.Kb(0,"ion-icon",19),a.Sb("click",(function(t){a.ic(n);var e=a.Wb().$implicit;return a.Wb(2).toggleTrackVisibility(e,t)})),a.Jb()}if(2&t){var r=a.Wb().$implicit;a.Zb("name",r.visible?"eye":"eye-off")}}function y(t,e){if(1&t){var n=a.Lb();a.Kb(0,"ion-item",12),a.Sb("click",(function(){a.ic(n);var t=e.$implicit;return a.Wb(2).viewItem(t)})),a.oc(1,h,1,0,"ion-icon",13),a.oc(2,d,1,0,"ion-icon",14),a.Kb(3,"ion-label"),a.Kb(4,"h2"),a.pc(5),a.Jb(),a.Kb(6,"h3"),a.pc(7),a.Jb(),a.oc(8,m,2,1,"p",15),a.Jb(),a.oc(9,g,1,1,"ion-icon",16),a.oc(10,v,1,1,"ion-icon",16),a.Jb()}if(2&t){var r=e.$implicit;a.xb(1),a.Zb("ngIf",!r.point_type),a.xb(1),a.Zb("ngIf",r.point_type),a.xb(3),a.qc(r.name),a.xb(2),a.qc(r.layer.name),a.xb(1),a.Zb("ngIf",r.layer&&r.layer.profile),a.xb(1),a.Zb("ngIf",r.point_type),a.xb(1),a.Zb("ngIf",!r.point_type)}}function k(t,e){if(1&t&&(a.Kb(0,"ion-list",10),a.Kb(1,"ion-list-header"),a.pc(2),a.Jb(),a.oc(3,y,11,7,"ion-item",11),a.Ib(4,"ion-item-divider"),a.Jb()),2&t){var n=e.$implicit;a.xb(2),a.rc(" ",n.group.name," "),a.xb(1),a.Zb("ngForOf",n.results)}}var x=function(){function t(t,e,n,i,o){var a,c,s,l,u=this;this.modalController=t,this.navParams=e,this.mapService=n,this.groupService=i,this.layerService=o;var b=this.navParams.get("search");this.search=b||"",this.loading=!0,this.searchResults=[];var p=this.navParams.get("default_layers")?this.navParams.get("default_layers"):[],f=Object.keys(p);this.defaultLayers=[];try{for(var h=Object(r.d)(f),d=h.next();!d.done;d=h.next()){var m=d.value;try{for(var g=(s=void 0,Object(r.d)(p[m])),v=g.next();!v.done;v=g.next())this.defaultLayers.push(v.value)}catch(y){s={error:y}}finally{try{v&&!v.done&&(l=g.return)&&l.call(g)}finally{if(s)throw s.error}}}}catch(k){a={error:k}}finally{try{d&&!d.done&&(c=h.return)&&c.call(h)}finally{if(a)throw a.error}}this.privateLayers=this.navParams.get("private_layers")?this.navParams.get("private_layers"):[],this.groups=[],this.groupLayers={},this.groupService.getJoinedGroups().then((function(t){var e,n;u.groups=t,u.loading=!1;try{for(var i=Object(r.d)(u.groups),o=i.next();!o.done;o=i.next()){var a=o.value;u.getGroupLayers(a.name,a.id)}}catch(c){e={error:c}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}})),this.doSearch()}return t.prototype.ngOnInit=function(){},t.prototype.getGroupLayers=function(t,e){var n=this;this.layerService.getGroupLayers(e).then((function(e){n.groupLayers[t]=e,n.doSearch()}))},t.prototype.doSearch=function(){var t,e;this.searchResults=[];var n=this.search?this.search.toLowerCase():"",i=this.getLayerResults(this.defaultLayers,n);i.length>0&&this.searchResults.push({group:{name:"Get Outdoors"},results:i});var o=this.getLayerResults(this.privateLayers,n);o.length>0&&this.searchResults.push({group:{name:"My Map"},results:o});try{for(var a=Object(r.d)(this.groups),c=a.next();!c.done;c=a.next()){var s=c.value;if(this.groupLayers[s.name]){var l=this.getLayerResults(this.groupLayers[s.name],n);l.length>0&&this.searchResults.push({group:{name:s.name},results:l})}}}catch(u){t={error:u}}finally{try{c&&!c.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}},t.prototype.getLayerResults=function(t,e){var n,i,o,a,c,s,l=[];try{for(var u=Object(r.d)(t),b=u.next();!b.done;b=u.next()){var p=b.value;try{for(var f=(o=void 0,Object(r.d)(p.tracks)),h=f.next();!h.done;h=f.next()){var d=h.value,m=d.name.toLowerCase();(!this.search||m.indexOf(e)>-1)&&(d.layer=p,l.push(d))}}catch(x){o={error:x}}finally{try{h&&!h.done&&(a=f.return)&&a.call(f)}finally{if(o)throw o.error}}try{for(var g=(c=void 0,Object(r.d)(p.placemarks)),v=g.next();!v.done;v=g.next()){var y=v.value,k=y.name.toLowerCase();(!this.search||k.indexOf(e)>-1)&&(y.layer=p,l.push(y))}}catch(K){c={error:K}}finally{try{v&&!v.done&&(s=g.return)&&s.call(g)}finally{if(c)throw c.error}}}}catch(J){n={error:J}}finally{try{b&&!b.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}return l},t.prototype.viewItem=function(t){t.point_type?(this.viewPlacemark(t),this.mapService.moveMaps(t.latitude,t.longitude)):t.id&&(this.viewTrack(t),this.mapService.moveMaps(t.points[0].latitude,t.points[0].longitude))},t.prototype.viewTrack=function(t){return Object(r.a)(this,void 0,void 0,(function(){var e;return Object(r.c)(this,(function(n){switch(n.label){case 0:return[4,this.modalController.create({component:i.a,componentProps:{track:t}})];case 1:return(e=n.sent()).onDidDismiss().then((function(t){})),[4,e.present()];case 2:return n.sent(),[2]}}))}))},t.prototype.viewPlacemark=function(t){return Object(r.a)(this,void 0,void 0,(function(){var e;return Object(r.c)(this,(function(n){switch(n.label){case 0:return[4,this.modalController.create({component:o.a,componentProps:{placemark:t}})];case 1:return(e=n.sent()).onDidDismiss().then((function(t){})),[4,e.present()];case 2:return n.sent(),[2]}}))}))},t.prototype.toggleTrackVisibility=function(t,e){e.preventDefault(),e.stopPropagation(),t.visible=!t.visible,t.visible?(console.log("adding"),console.log(t),this.mapService.showTrack(t)):this.mapService.hideTrack(t)},t.prototype.togglePlacemarkVisibility=function(t,e){e.preventDefault(),e.stopPropagation(),t.visible=!t.visible,t.visible?(console.log("adding"),console.log(t),this.mapService.showPlacemark(t)):this.mapService.hidePlacemark(t)},t.prototype.dismiss=function(){this.modalController.dismiss()},t.\u0275fac=function(e){return new(e||t)(a.Hb(c.K),a.Hb(c.M),a.Hb(s.a),a.Hb(l.a),a.Hb(u.a))},t.\u0275cmp=a.Bb({type:t,selectors:[["app-search"]],decls:12,vars:3,consts:[["color","primary"],["slot","start"],[3,"click"],["name","close"],[1,"search"],[1,"search__input"],["clearInput","","placeholder","Search","type","text","name","search",3,"ngModel","ngModelChange","ionChange"],["class","search__loading",4,"ngIf"],["class","search__list",4,"ngFor","ngForOf"],[1,"search__loading"],[1,"search__list"],["lines","none",3,"click",4,"ngFor","ngForOf"],["lines","none",3,"click"],["slot","start","name","analytics",4,"ngIf"],["slot","start","name","location",4,"ngIf"],[4,"ngIf"],["slot","end",3,"name","click",4,"ngIf"],["slot","start","name","analytics"],["slot","start","name","location"],["slot","end",3,"name","click"]],template:function(t,e){1&t&&(a.Kb(0,"ion-header"),a.Kb(1,"ion-toolbar",0),a.Kb(2,"ion-buttons",1),a.Kb(3,"ion-button",2),a.Sb("click",(function(){return e.dismiss()})),a.Ib(4,"ion-icon",3),a.Jb(),a.Jb(),a.Kb(5,"ion-title"),a.pc(6,"Find Track/placemark"),a.Jb(),a.Jb(),a.Jb(),a.Kb(7,"ion-content",4),a.Kb(8,"ion-item",5),a.Kb(9,"ion-input",6),a.Sb("ngModelChange",(function(t){return e.search=t}))("ionChange",(function(){return e.doSearch()})),a.Jb(),a.Jb(),a.oc(10,f,2,0,"div",7),a.oc(11,k,5,2,"ion-list",8),a.Jb()),2&t&&(a.xb(9),a.Zb("ngModel",e.search),a.xb(1),a.Zb("ngIf",e.loading),a.xb(1),a.Zb("ngForOf",e.searchResults))},directives:[c.o,c.F,c.h,c.g,c.p,c.E,c.k,c.r,c.q,c.Q,b.e,b.h,p.j,p.i,c.C,c.u,c.v,c.s,c.t],styles:[".search__loading[_ngcontent-%COMP%]{padding-top:40px;padding-bottom:60px;text-align:center}.search__loading[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{margin:0 auto;width:30px;height:30px}"]}),t}()},IEcJ:function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));var r=n("AytR"),i=n("fXoL"),o=n("tyNb"),a=n("B7Rs"),c=n("a/9d"),s=n("TEn/"),l=n("ri4K"),u=n("ZH29"),b=n("3Pt+"),p=n("ofXK");function f(t,e){1&t&&i.Ib(0,"ion-icon",14)}function h(t,e){if(1&t&&(i.Kb(0,"ion-avatar",15),i.Ib(1,"img",16),i.Jb()),2&t){var n=i.Wb();i.xb(1),i.Zb("src",n.placemark.image,i.kc)}}function d(t,e){if(1&t){var n=i.Lb();i.Kb(0,"ion-button",17),i.Sb("click",(function(){return i.ic(n),i.Wb().placemark.image=""})),i.pc(1,"Delete"),i.Jb()}}var m=function(){function t(t,e,n,r,i,o,a,c,s,l){this.router=t,this.transfer=e,this.camera=n,this.loadingController=r,this.alertController=i,this.modalController=o,this.navController=a,this.authenticationService=c,this.navParams=s,this.keyboard=l,this.placemark={};var u=this.navParams.get("placemark");this.placemark=Object.assign({},u)}return t.prototype.ngOnInit=function(){},t.prototype.showKeyboard=function(){this.keyboard.show()},t.prototype.hideKeyboard=function(){this.keyboard.hide()},t.prototype.changeImage=function(t){var e=this;this.camera.getPicture({sourceType:"camera"===t?this.camera.PictureSourceType.CAMERA:this.camera.PictureSourceType.PHOTOLIBRARY,destinationType:this.camera.DestinationType.FILE_URI,encodingType:this.camera.EncodingType.JPEG,quality:25}).then((function(t){var n;e.loadingController.create({message:"Your image is being uploaded. Please wait...",duration:2e4}).then((function(t){n=t,t.present()}));var i=e.transfer.create(),o={fileKey:"media_file",fileName:Math.random().toString(36).substring(2),params:{},mimeType:"image/jpeg"};i.upload(t,encodeURI(r.a.apiUrl+"/upload"),o).then((function(t){if(t.response){var r=JSON.parse(t.response);e.placemark.image=r.file}n.dismiss()}),(function(t){e.alertController.create({header:"Error",subHeader:"There was a problem uploading your image",message:JSON.stringify(t),buttons:[{text:"Dismiss",role:"cancel"}]}).then((function(t){t.present()})),n.dismiss()}))}),(function(t){}))},t.prototype.dismiss=function(){this.modalController.dismiss()},t.prototype.update=function(){this.modalController.dismiss({placemark:this.placemark})},t.\u0275fac=function(e){return new(e||t)(i.Hb(o.g),i.Hb(a.a),i.Hb(c.a),i.Hb(s.I),i.Hb(s.a),i.Hb(s.K),i.Hb(s.L),i.Hb(l.a),i.Hb(s.M),i.Hb(u.a))},t.\u0275cmp=i.Bb({type:t,selectors:[["app-edit-placemark"]],decls:27,vars:5,consts:[["color","primary"],["slot","start"],[3,"click"],["name","close"],["position","floating"],["clearInput","","type","text",3,"ngModel","ngModelChange"],[1,"edit-placemark-image"],["name","home",4,"ngIf"],["item-start","",4,"ngIf"],["color","primary",3,"click"],["color","primary","fill","clear",3,"click",4,"ngIf"],[3,"ngModel","ngModelChange"],[1,"edit-layer-footer"],["color","primary","expand","full",1,"edit-layer-footer__button",3,"click"],["name","home"],["item-start",""],[3,"src"],["color","primary","fill","clear",3,"click"]],template:function(t,e){1&t&&(i.Kb(0,"ion-header"),i.Kb(1,"ion-toolbar",0),i.Kb(2,"ion-buttons",1),i.Kb(3,"ion-button",2),i.Sb("click",(function(){return e.dismiss()})),i.Ib(4,"ion-icon",3),i.Jb(),i.Jb(),i.Kb(5,"ion-title"),i.pc(6,"Edit Placemark"),i.Jb(),i.Jb(),i.Jb(),i.Kb(7,"ion-content"),i.Kb(8,"ion-item"),i.Kb(9,"ion-label",4),i.pc(10,"Name"),i.Jb(),i.Kb(11,"ion-input",5),i.Sb("ngModelChange",(function(t){return e.placemark.name=t})),i.Jb(),i.Jb(),i.Kb(12,"ion-item",6),i.oc(13,f,1,0,"ion-icon",7),i.oc(14,h,2,1,"ion-avatar",8),i.Kb(15,"ion-button",9),i.Sb("click",(function(){return e.changeImage("library")})),i.pc(16,"Select Image"),i.Jb(),i.Kb(17,"ion-button",9),i.Sb("click",(function(){return e.changeImage("camera")})),i.pc(18,"Take Picture"),i.Jb(),i.oc(19,d,2,0,"ion-button",10),i.Jb(),i.Kb(20,"ion-item"),i.Kb(21,"ion-label",4),i.pc(22,"Description"),i.Jb(),i.Kb(23,"ion-textarea",11),i.Sb("ngModelChange",(function(t){return e.placemark.description=t})),i.Jb(),i.Jb(),i.Jb(),i.Kb(24,"ion-footer",12),i.Kb(25,"ion-button",13),i.Sb("click",(function(){return e.update()})),i.pc(26," Update "),i.Jb(),i.Jb()),2&t&&(i.xb(11),i.Zb("ngModel",e.placemark.name),i.xb(2),i.Zb("ngIf",!e.placemark.image),i.xb(1),i.Zb("ngIf",e.placemark.image),i.xb(5),i.Zb("ngIf",e.placemark.image),i.xb(4),i.Zb("ngModel",e.placemark.description))},directives:[s.o,s.F,s.h,s.g,s.p,s.E,s.k,s.r,s.t,s.q,s.Q,b.e,b.h,p.j,s.D,s.n,s.d],styles:[".edit-placemark-image[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:5px}.edit-placemark-image[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{width:20px;height:20px;padding:10px;border-radius:20px;background-color:#000;color:#fff;margin-bottom:5px}.edit-placemark-image[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]{margin-bottom:5px}.edit-placemark-image[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin-left:15px}angular-editor[_ngcontent-%COMP%]{margin-top:20px;display:block}"]}),t}()},S8vU:function(t,e,n){"use strict";n.d(e,"a",(function(){return b}));var r=n("AytR"),i=n("fXoL"),o=n("tyNb"),a=n("B7Rs"),c=n("a/9d"),s=n("TEn/"),l=n("ri4K"),u=n("3Pt+"),b=function(){function t(t,e,n,r,i,o,a,c,s){this.router=t,this.transfer=e,this.camera=n,this.loadingController=r,this.alertController=i,this.modalController=o,this.navController=a,this.authenticationService=c,this.navParams=s,this.track={};var l=this.navParams.get("track");this.track=Object.assign({},l)}return t.prototype.ngOnInit=function(){},t.prototype.changeImage=function(){var t=this;this.camera.getPicture({sourceType:this.camera.PictureSourceType.PHOTOLIBRARY,destinationType:this.camera.DestinationType.FILE_URI,encodingType:this.camera.EncodingType.JPEG,quality:25}).then((function(e){var n;t.loadingController.create({message:"Your image is being uploaded. Please wait...",duration:2e4}).then((function(t){n=t,t.present()}));var i=t.transfer.create(),o={fileKey:"media_file",fileName:Math.random().toString(36).substring(2),params:{},mimeType:"image/jpeg"};i.upload(e,encodeURI(r.a.apiUrl+"/upload"),o).then((function(e){if(e.response){var r=JSON.parse(e.response);t.track.image=r.file}n.dismiss()}),(function(e){t.alertController.create({header:"Error",subHeader:"There was a problem uploading your image",message:JSON.stringify(e),buttons:[{text:"Dismiss",role:"cancel"}]}).then((function(t){t.present()})),n.dismiss()}))}),(function(t){}))},t.prototype.dismiss=function(){this.modalController.dismiss()},t.prototype.update=function(){this.modalController.dismiss({track:this.track})},t.\u0275fac=function(e){return new(e||t)(i.Hb(o.g),i.Hb(a.a),i.Hb(c.a),i.Hb(s.I),i.Hb(s.a),i.Hb(s.K),i.Hb(s.L),i.Hb(l.a),i.Hb(s.M))},t.\u0275cmp=i.Bb({type:t,selectors:[["app-edit-track"]],decls:15,vars:1,consts:[["color","primary"],["slot","start"],[3,"click"],["name","close"],["position","floating"],["clearInput","","type","text",3,"ngModel","ngModelChange"],[1,"edit-layer-footer"],["color","primary","expand","full",1,"edit-layer-footer__button",3,"click"]],template:function(t,e){1&t&&(i.Kb(0,"ion-header"),i.Kb(1,"ion-toolbar",0),i.Kb(2,"ion-buttons",1),i.Kb(3,"ion-button",2),i.Sb("click",(function(){return e.dismiss()})),i.Ib(4,"ion-icon",3),i.Jb(),i.Jb(),i.Kb(5,"ion-title"),i.pc(6,"Edit Track"),i.Jb(),i.Jb(),i.Jb(),i.Kb(7,"ion-content"),i.Kb(8,"ion-item"),i.Kb(9,"ion-label",4),i.pc(10,"Name"),i.Jb(),i.Kb(11,"ion-input",5),i.Sb("ngModelChange",(function(t){return e.track.name=t})),i.Jb(),i.Jb(),i.Jb(),i.Kb(12,"ion-footer",6),i.Kb(13,"ion-button",7),i.Sb("click",(function(){return e.update()})),i.pc(14," Update "),i.Jb(),i.Jb()),2&t&&(i.xb(11),i.Zb("ngModel",e.track.name))},directives:[s.o,s.F,s.h,s.g,s.p,s.E,s.k,s.r,s.t,s.q,s.Q,u.e,u.h,s.n],styles:[""]}),t}()},rVxE:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("AytR"),i=n("fXoL"),o=n("tk/3"),a=n("e8h1"),c=function(){function t(t,e){this.http=t,this.storage=e}return t.prototype.getLogs=function(t){var e=this;return new Promise((function(n,i){e.storage.get("go_token").then((function(o){o?e.http.get(r.a.apiUrl+"/logs?token="+o+"&search="+t).subscribe((function(t){e.storage.set("go_logs",t),n(t)}),(function(t){e.storage.get("go_logs").then((function(e){e?n(e):i(t)}))})):i()}))}))},t.prototype.createLog=function(t){var e=this;return new Promise((function(n,i){e.storage.get("go_token").then((function(o){o?e.http.post(r.a.apiUrl+"/logs?token="+o,t).subscribe((function(t){n(t)}),(function(t){i(t)})):i()}))}))},t.prototype.editLog=function(t){var e=this;return new Promise((function(n,i){e.storage.get("go_token").then((function(o){o?e.http.put(r.a.apiUrl+"/logs/"+t.id+"?token="+o,t).subscribe((function(t){n(t)}),(function(t){i(t)})):i()}))}))},t.prototype.deleteLog=function(t){var e=this;return new Promise((function(n,i){e.storage.get("go_token").then((function(o){o?e.http.delete(r.a.apiUrl+"/logs/"+t+"?token="+o).subscribe((function(t){n(t)}),(function(t){i(t)})):i()}))}))},t.\u0275fac=function(e){return new(e||t)(i.Ob(o.a),i.Ob(a.b))},t.\u0275prov=i.Db({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()},uFMf:function(t,e,n){"use strict";n.d(e,"a",(function(){return g}));var r=n("mrSG"),i=n("wd/R"),o=n("uxLX"),a=n("S8vU"),c=n("fXoL"),s=n("TEn/"),l=n("ri4K"),u=n("rVxE"),b=n("ofXK"),p=n("k/Yu");function f(t,e){if(1&t){var n=c.Lb();c.Kb(0,"ion-buttons",9),c.Kb(1,"ion-button",2),c.Sb("click",(function(){return c.ic(n),c.Wb().editTrack()})),c.pc(2," Edit "),c.Jb(),c.Kb(3,"ion-button",2),c.Sb("click",(function(){return c.ic(n),c.Wb().deleteTrack()})),c.pc(4," Delete "),c.Jb(),c.Jb()}}function h(t,e){if(1&t&&c.Ib(0,"img",10),2&t){var n=c.Wb();c.Zb("src",n.track.image,c.kc)}}function d(t,e){if(1&t&&(c.Kb(0,"div",13),c.Ib(1,"img",14),c.Jb()),2&t){var n=e.$implicit;c.xb(1),c.Zb("src",n.image,c.kc)("alt",n.fileName)}}function m(t,e){if(1&t&&(c.Kb(0,"div",11),c.oc(1,d,2,2,"div",12),c.Jb()),2&t){var n=c.Wb();c.xb(1),c.Zb("ngForOf",n.gallery)}}var g=function(){function t(t,e,n,r,i,o){var a=this;this.modalController=t,this.navParams=e,this.authenticationService=n,this.logService=r,this.alertController=i,this.toastController=o;var c=this.navParams.get("track");this.track=c||{},this.gallery=this.track.gallery?JSON.parse(this.track.gallery):[],this.user={},this.authenticationService.getUserData().subscribe((function(t){a.user=t}))}return t.prototype.ngOnInit=function(){},t.prototype.openProfile=function(t){return Object(r.a)(this,void 0,void 0,(function(){var e;return Object(r.c)(this,(function(n){switch(n.label){case 0:return[4,this.modalController.create({component:o.a,componentProps:{profile:t}})];case 1:return(e=n.sent()).onDidDismiss().then((function(t){})),[4,e.present()];case 2:return n.sent(),[2]}}))}))},t.prototype.formatFromNow=function(t){return i(t).from(i())},t.prototype.editTrack=function(){return Object(r.a)(this,void 0,void 0,(function(){var t,e,n=this;return Object(r.c)(this,(function(r){switch(r.label){case 0:return t={},Object.assign(t,this.track),[4,this.modalController.create({component:a.a,componentProps:{track:t}})];case 1:return(e=r.sent()).onDidDismiss().then((function(t){if(t&&t.data){var e=t.data.track;e.edited=!0,setTimeout((function(){n.modalController.dismiss({track:e})}),500)}})),[4,e.present()];case 2:return r.sent(),[2]}}))}))},t.prototype.update=function(t){},t.prototype.deleteTrack=function(){return Object(r.a)(this,void 0,void 0,(function(){var t=this;return Object(r.c)(this,(function(e){switch(e.label){case 0:return[4,this.alertController.create({header:"Delete "+this.track.name,message:"Are you sure?",buttons:[{text:"Cancel",role:"cancel",handler:function(){}},{text:"Yes",handler:function(){t.track.deleted=!0,setTimeout((function(){t.modalController.dismiss({track:t.track})}),500)}}]})];case 1:return[4,e.sent().present()];case 2:return e.sent(),[2]}}))}))},t.prototype.planTrip=function(){return Object(r.a)(this,void 0,void 0,(function(){var t=this;return Object(r.c)(this,(function(e){switch(e.label){case 0:return[4,this.alertController.create({header:"Plan Trip",message:"Are you sure? This will add an entry to your log.",buttons:[{text:"Cancel",role:"cancel",handler:function(){}},{text:"Yes",handler:function(){t.logService.createLog({title:"Planned Trip",description:"Trip was planned for "+t.track.name}).then((function(e){t.showPlanTripToast()}))}}]})];case 1:return[4,e.sent().present()];case 2:return e.sent(),[2]}}))}))},t.prototype.showPlanTripToast=function(){return Object(r.a)(this,void 0,void 0,(function(){return Object(r.c)(this,(function(t){switch(t.label){case 0:return[4,this.toastController.create({message:"Trip added to your log!",duration:4e3})];case 1:return t.sent().present(),[2]}}))}))},t.prototype.dismiss=function(){this.modalController.dismiss()},t.\u0275fac=function(e){return new(e||t)(c.Hb(s.K),c.Hb(s.M),c.Hb(l.a),c.Hb(u.a),c.Hb(s.a),c.Hb(s.R))},t.\u0275cmp=c.Bb({type:t,selectors:[["app-view-track"]],decls:20,vars:7,consts:[["color","primary"],["slot","start"],[3,"click"],["name","close"],["slot","end",4,"ngIf"],[1,"ion-padding","track"],[1,"track__details"],["lightbox","",3,"src",4,"ngIf"],["lightbox-group","","class","track__gallery",4,"ngIf"],["slot","end"],["lightbox","",3,"src"],["lightbox-group","",1,"track__gallery"],["class","track__gallery__item",4,"ngFor","ngForOf"],[1,"track__gallery__item"],["lightbox","",3,"src","alt"]],template:function(t,e){1&t&&(c.Kb(0,"ion-header"),c.Kb(1,"ion-toolbar",0),c.Kb(2,"ion-buttons",1),c.Kb(3,"ion-button",2),c.Sb("click",(function(){return e.dismiss()})),c.Ib(4,"ion-icon",3),c.Jb(),c.Jb(),c.oc(5,f,5,0,"ion-buttons",4),c.Kb(6,"ion-title"),c.pc(7),c.Jb(),c.Jb(),c.Jb(),c.Kb(8,"ion-content",5),c.Kb(9,"div",6),c.Kb(10,"h4"),c.pc(11,"Created by "),c.Kb(12,"a",2),c.Sb("click",(function(){return e.openProfile(e.track.profile.user_id)})),c.pc(13),c.Jb(),c.Jb(),c.Kb(14,"span"),c.pc(15),c.Jb(),c.Jb(),c.oc(16,h,1,1,"img",7),c.oc(17,m,2,1,"div",8),c.Kb(18,"p"),c.pc(19),c.Jb(),c.Jb()),2&t&&(c.xb(5),c.Zb("ngIf",e.track.user_id===e.user.id),c.xb(2),c.qc(e.track.name),c.xb(6),c.qc(e.track.profile.name),c.xb(2),c.rc("Created ",e.formatFromNow(e.track.created_at),""),c.xb(1),c.Zb("ngIf",e.track.image),c.xb(1),c.Zb("ngIf",e.gallery&&e.gallery.length>0),c.xb(2),c.qc(e.track.description))},directives:[s.o,s.F,s.h,s.g,s.p,b.j,s.E,s.k,p.b,p.c,b.i],styles:[""]}),t}()},xGJU:function(t,e,n){"use strict";n.d(e,"a",(function(){return g}));var r=n("mrSG"),i=n("wd/R"),o=n("uxLX"),a=n("IEcJ"),c=n("fXoL"),s=n("TEn/"),l=n("ri4K"),u=n("rVxE"),b=n("ofXK"),p=n("k/Yu");function f(t,e){if(1&t){var n=c.Lb();c.Kb(0,"ion-buttons",10),c.Kb(1,"ion-button",2),c.Sb("click",(function(){return c.ic(n),c.Wb().editPlacemark()})),c.pc(2," Edit "),c.Jb(),c.Kb(3,"ion-button",2),c.Sb("click",(function(){return c.ic(n),c.Wb().deletePlacemark()})),c.pc(4," Delete "),c.Jb(),c.Jb()}}function h(t,e){if(1&t&&c.Ib(0,"img",11),2&t){var n=c.Wb();c.Zb("src",n.placemark.image,c.kc)}}function d(t,e){if(1&t&&(c.Kb(0,"div",14),c.Ib(1,"img",15),c.Jb()),2&t){var n=e.$implicit;c.xb(1),c.Zb("src",n.image,c.kc)("alt",n.fileName)}}function m(t,e){if(1&t&&(c.Kb(0,"div",12),c.oc(1,d,2,2,"div",13),c.Jb()),2&t){var n=c.Wb();c.xb(1),c.Zb("ngForOf",n.gallery)}}var g=function(){function t(t,e,n,r,i,o){var a=this;this.modalController=t,this.navParams=e,this.authenticationService=n,this.logService=r,this.alertController=i,this.toastController=o;var c=this.navParams.get("placemark");this.placemark=c||{},this.gallery=this.placemark.gallery?JSON.parse(this.placemark.gallery):[],this.user={},this.authenticationService.getUserData().subscribe((function(t){a.user=t}))}return t.prototype.ngOnInit=function(){},t.prototype.openProfile=function(t){return Object(r.a)(this,void 0,void 0,(function(){var e;return Object(r.c)(this,(function(n){switch(n.label){case 0:return[4,this.modalController.create({component:o.a,componentProps:{profile:t}})];case 1:return(e=n.sent()).onDidDismiss().then((function(t){})),[4,e.present()];case 2:return n.sent(),[2]}}))}))},t.prototype.formatFromNow=function(t){return i(t).from(i())},t.prototype.editPlacemark=function(){return Object(r.a)(this,void 0,void 0,(function(){var t,e,n=this;return Object(r.c)(this,(function(r){switch(r.label){case 0:return t={},Object.assign(t,this.placemark),[4,this.modalController.create({component:a.a,componentProps:{placemark:t}})];case 1:return(e=r.sent()).onDidDismiss().then((function(t){if(t&&t.data){var e=t.data.placemark;e.edited=!0,setTimeout((function(){n.modalController.dismiss({placemark:e})}),500)}})),[4,e.present()];case 2:return r.sent(),[2]}}))}))},t.prototype.deletePlacemark=function(){return Object(r.a)(this,void 0,void 0,(function(){var t=this;return Object(r.c)(this,(function(e){switch(e.label){case 0:return[4,this.alertController.create({header:"Delete "+this.placemark.name,message:"Are you sure?",buttons:[{text:"Cancel",role:"cancel",handler:function(){}},{text:"Yes",handler:function(){t.placemark.deleted=!0,setTimeout((function(){t.modalController.dismiss({placemark:t.placemark})}),500)}}]})];case 1:return[4,e.sent().present()];case 2:return e.sent(),[2]}}))}))},t.prototype.planTrip=function(){return Object(r.a)(this,void 0,void 0,(function(){var t=this;return Object(r.c)(this,(function(e){switch(e.label){case 0:return[4,this.alertController.create({header:"Plan Trip",message:"Are you sure? This will add an entry to your log.",buttons:[{text:"Cancel",role:"cancel",handler:function(){}},{text:"Yes",handler:function(){t.logService.createLog({title:"Planned Trip",description:"Trip was planned for "+t.placemark.name}).then((function(e){t.showPlanTripToast()}))}}]})];case 1:return[4,e.sent().present()];case 2:return e.sent(),[2]}}))}))},t.prototype.showPlanTripToast=function(){return Object(r.a)(this,void 0,void 0,(function(){return Object(r.c)(this,(function(t){switch(t.label){case 0:return[4,this.toastController.create({message:"Trip added to your log!",duration:4e3})];case 1:return t.sent().present(),[2]}}))}))},t.prototype.dismiss=function(){this.modalController.dismiss()},t.\u0275fac=function(e){return new(e||t)(c.Hb(s.K),c.Hb(s.M),c.Hb(l.a),c.Hb(u.a),c.Hb(s.a),c.Hb(s.R))},t.\u0275cmp=c.Bb({type:t,selectors:[["app-view-placemark"]],decls:19,vars:7,consts:[["color","primary"],["slot","start"],[3,"click"],["name","close"],["slot","end",4,"ngIf"],[1,"ion-padding","placemark"],[1,"placemark__details"],["lightbox","",3,"src",4,"ngIf"],["lightbox-group","","class","placemark__gallery",4,"ngIf"],[3,"innerHTML"],["slot","end"],["lightbox","",3,"src"],["lightbox-group","",1,"placemark__gallery"],["class","placemark__gallery__item",4,"ngFor","ngForOf"],[1,"placemark__gallery__item"],["lightbox","",3,"src","alt"]],template:function(t,e){1&t&&(c.Kb(0,"ion-header"),c.Kb(1,"ion-toolbar",0),c.Kb(2,"ion-buttons",1),c.Kb(3,"ion-button",2),c.Sb("click",(function(){return e.dismiss()})),c.Ib(4,"ion-icon",3),c.Jb(),c.Jb(),c.oc(5,f,5,0,"ion-buttons",4),c.Kb(6,"ion-title"),c.pc(7),c.Jb(),c.Jb(),c.Jb(),c.Kb(8,"ion-content",5),c.Kb(9,"div",6),c.Kb(10,"h4"),c.pc(11,"Created by "),c.Kb(12,"a",2),c.Sb("click",(function(){return e.openProfile(e.placemark.profile.user_id)})),c.pc(13),c.Jb(),c.Jb(),c.Kb(14,"span"),c.pc(15),c.Jb(),c.Jb(),c.oc(16,h,1,1,"img",7),c.oc(17,m,2,1,"div",8),c.Ib(18,"p",9),c.Jb()),2&t&&(c.xb(5),c.Zb("ngIf",e.placemark.user_id===e.user.id),c.xb(2),c.qc(e.placemark.name),c.xb(6),c.qc(e.placemark.profile.name),c.xb(2),c.rc("Created ",e.formatFromNow(e.placemark.created_at),""),c.xb(1),c.Zb("ngIf",e.placemark.image),c.xb(1),c.Zb("ngIf",e.gallery&&e.gallery.length>0),c.xb(1),c.Zb("innerHTML",e.placemark.description,c.jc))},directives:[s.o,s.F,s.h,s.g,s.p,b.j,s.E,s.k,p.b,p.c,b.i],styles:[""]}),t}()}}]);