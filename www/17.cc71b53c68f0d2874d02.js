(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{IYJ9:function(n,t,i){"use strict";i.d(t,"a",(function(){return s}));var o=i("AytR"),e=i("fXoL"),c=i("tk/3"),r=i("e8h1"),s=function(){function n(n,t){this.http=n,this.storage=t}return n.prototype.upgrade=function(n){var t=this;return new Promise((function(i,e){t.storage.get("go_token").then((function(c){c?t.http.post(o.a.apiUrl+"/subscriptions/start?token="+c,{id:n}).subscribe((function(n){i(n)}),(function(n){e(n)})):e()}))}))},n.prototype.cancel=function(){var n=this;return new Promise((function(t,i){n.storage.get("go_token").then((function(e){e?n.http.post(o.a.apiUrl+"/subscriptions/cancel?token="+e,{}).subscribe((function(n){t(n)}),(function(n){i(n)})):i()}))}))},n.prototype.getInvoices=function(){var n=this;return new Promise((function(t,i){n.storage.get("go_token").then((function(e){e?n.http.get(o.a.apiUrl+"/invoices?token="+e).subscribe((function(n){t(n)}),(function(n){i(n)})):i()}))}))},n.prototype.getInvoice=function(n){var t=this;return new Promise((function(i,e){t.storage.get("go_token").then((function(c){c?t.http.get(o.a.apiUrl+"/invoices/"+n+"?token="+c).subscribe((function(n){i(n)}),(function(n){e(n)})):e()}))}))},n.\u0275fac=function(t){return new(t||n)(e.Ob(c.a),e.Ob(r.b))},n.\u0275prov=e.Db({token:n,factory:n.\u0275fac,providedIn:"root"}),n}()},OAiQ:function(n,t,i){"use strict";i.d(t,"a",(function(){return v}));var o=i("mrSG"),e=i("wd/R"),c=i("AytR"),r=i("fXoL"),s=i("IYJ9"),a=i("TEn/"),u=i("ri4K"),l=i("m/P+"),b=i("e8h1"),f=i("ofXK");function p(n,t){1&n&&r.Ib(0,"ion-spinner",9)}function h(n,t){if(1&n){var i=r.Lb();r.Kb(0,"ion-button",7),r.Sb("click",(function(){return r.ec(i),r.Ub().cancelSubscription()})),r.lc(1," Cancel Subscription "),r.kc(2,p,1,0,"ion-spinner",8),r.Jb()}if(2&n){var o=r.Ub();r.Xb("disabled",o.loading),r.xb(2),r.Xb("ngIf",o.cancelLoading)}}function g(n,t){if(1&n){var i=r.Lb();r.Kb(0,"ion-item"),r.Kb(1,"ion-label",12),r.Kb(2,"h2"),r.lc(3),r.Jb(),r.Kb(4,"p"),r.lc(5),r.Jb(),r.Jb(),r.Kb(6,"ion-button",13),r.Sb("click",(function(){r.ec(i);var n=t.$implicit;return r.Ub(2).downloadInvoice(n.id)})),r.lc(7," Download "),r.Jb(),r.Jb()}if(2&n){var o=t.$implicit;r.xb(3),r.nc("Paid ",o.total,""),r.xb(2),r.nc(" ",o.date," ")}}function d(n,t){if(1&n&&(r.Kb(0,"ion-list",10),r.Kb(1,"ion-list-header"),r.lc(2," Invoices "),r.Jb(),r.kc(3,g,8,2,"ion-item",11),r.Jb()),2&n){var i=r.Ub();r.xb(3),r.Xb("ngForOf",i.invoices)}}var v=function(){function n(n,t,i,o,e,c,r){var s=this;this.billingService=n,this.modalController=t,this.alertController=i,this.authenticationService=o,this.iab=e,this.toastController=c,this.storage=r,this.user={},this.authenticationService.getUserData().subscribe((function(n){s.user=n})),this.loading=!0,this.invoices=[],this.getInvoices()}return n.prototype.ngOnInit=function(){},n.prototype.getInvoices=function(){var n=this;this.billingService.getInvoices().then((function(t){n.loading=!1,n.invoices=t}))},n.prototype.downloadInvoice=function(n){var t=this;this.storage.get("go_token").then((function(i){i&&t.iab.create(c.a.apiUrl+"/invoices/"+n+"?token="+i,"_system")}))},n.prototype.cancelSubscription=function(){return Object(o.a)(this,void 0,void 0,(function(){var n=this;return Object(o.c)(this,(function(t){switch(t.label){case 0:return[4,this.alertController.create({header:"Cancel Subscription",message:"Are you sure?",buttons:[{text:"Cancel",role:"cancel",handler:function(){}},{text:"Yes",handler:function(){n.cancelLoading=!0,n.billingService.cancel().then((function(){n.showToast("Subscription Cancelled"),n.getInvoices(),n.authenticationService.getUserData().toPromise().then((function(t){n.user=t}))})).catch((function(t){n.cancelLoading=!1,n.showToast("Failed To Cancel Subscription")}))}}]})];case 1:return[4,t.sent().present()];case 2:return t.sent(),[2]}}))}))},n.prototype.showToast=function(n){return Object(o.a)(this,void 0,void 0,(function(){return Object(o.c)(this,(function(t){switch(t.label){case 0:return[4,this.toastController.create({message:n,duration:4e3})];case 1:return t.sent().present(),[2]}}))}))},n.prototype.formatDate=function(n){return e(n).format("dddd, MMMM Do YYYY")},n.prototype.formatTime=function(n){return e(n).format("h:mma")},n.prototype.dismiss=function(){this.modalController.dismiss()},n.\u0275fac=function(t){return new(t||n)(r.Hb(s.a),r.Hb(a.L),r.Hb(a.a),r.Hb(u.a),r.Hb(l.a),r.Hb(a.S),r.Hb(b.b))},n.\u0275cmp=r.Bb({type:n,selectors:[["app-billing"]],decls:10,vars:2,consts:[["color","primary"],["slot","start"],[3,"click"],["name","close"],[1,"billing"],["color","primary",3,"disabled","click",4,"ngIf"],["class","billing__billing-list",4,"ngIf"],["color","primary",3,"disabled","click"],["color","light","class","billing__cancel-spinner",4,"ngIf"],["color","light",1,"billing__cancel-spinner"],[1,"billing__billing-list"],[4,"ngFor","ngForOf"],[1,"ion-text-wrap"],["slot","end",3,"click"]],template:function(n,t){1&n&&(r.Kb(0,"ion-header"),r.Kb(1,"ion-toolbar",0),r.Kb(2,"ion-buttons",1),r.Kb(3,"ion-button",2),r.Sb("click",(function(){return t.dismiss()})),r.Ib(4,"ion-icon",3),r.Jb(),r.Jb(),r.Kb(5,"ion-title"),r.lc(6,"Billing"),r.Jb(),r.Jb(),r.Jb(),r.Kb(7,"ion-content",4),r.kc(8,h,3,2,"ion-button",5),r.kc(9,d,4,1,"ion-list",6),r.Jb()),2&n&&(r.xb(8),r.Xb("ngIf",t.user.stripe_id&&t.user.subscription&&!t.user.subscription.ends_at),r.xb(1),r.Xb("ngIf",t.invoices&&t.invoices.length>0))},directives:[a.o,a.G,a.h,a.g,a.p,a.F,a.k,f.j,a.D,a.u,a.v,f.i,a.r,a.t],styles:[""]}),n}()},nmdT:function(n,t,i){"use strict";i.r(t),i.d(t,"BillingPageModule",(function(){return b}));var o=i("ofXK"),e=i("3Pt+"),c=i("TEn/"),r=i("tyNb"),s=i("OAiQ"),a=i("fXoL"),u=[{path:"",component:s.a}],l=function(){function n(){}return n.\u0275mod=a.Fb({type:n}),n.\u0275inj=a.Eb({factory:function(t){return new(t||n)},imports:[[r.j.forChild(u)],r.j]}),n}(),b=function(){function n(){}return n.\u0275mod=a.Fb({type:n}),n.\u0275inj=a.Eb({factory:function(t){return new(t||n)},imports:[[o.b,e.a,c.H,l]]}),n}()}}]);