(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{IYJ9:function(n,t,i){"use strict";i.d(t,"a",(function(){return s}));var o=i("AytR"),e=i("fXoL"),r=i("tk/3"),c=i("e8h1"),s=function(){function n(n,t){this.http=n,this.storage=t}return n.prototype.upgrade=function(n){var t=this;return new Promise((function(i,e){t.storage.get("go_token").then((function(r){r?t.http.post(o.a.apiUrl+"/subscriptions/start?token="+r,{id:n}).subscribe((function(n){i(n)}),(function(n){e(n)})):e()}))}))},n.prototype.cancel=function(){var n=this;return new Promise((function(t,i){n.storage.get("go_token").then((function(e){e?n.http.post(o.a.apiUrl+"/subscriptions/cancel?token="+e,{}).subscribe((function(n){t(n)}),(function(n){i(n)})):i()}))}))},n.prototype.getInvoices=function(){var n=this;return new Promise((function(t,i){n.storage.get("go_token").then((function(e){e?n.http.get(o.a.apiUrl+"/invoices?token="+e).subscribe((function(n){t(n)}),(function(n){i(n)})):i()}))}))},n.prototype.getInvoice=function(n){var t=this;return new Promise((function(i,e){t.storage.get("go_token").then((function(r){r?t.http.get(o.a.apiUrl+"/invoices/"+n+"?token="+r).subscribe((function(n){i(n)}),(function(n){e(n)})):e()}))}))},n.\u0275fac=function(t){return new(t||n)(e.Ob(r.a),e.Ob(c.b))},n.\u0275prov=e.Db({token:n,factory:n.\u0275fac,providedIn:"root"}),n}()},OAiQ:function(n,t,i){"use strict";i.d(t,"a",(function(){return v}));var o=i("mrSG"),e=i("wd/R"),r=i("AytR"),c=i("fXoL"),s=i("IYJ9"),a=i("TEn/"),u=i("ri4K"),b=i("m/P+"),l=i("e8h1"),f=i("ofXK");function p(n,t){1&n&&c.Ib(0,"ion-spinner",9)}function h(n,t){if(1&n){var i=c.Lb();c.Kb(0,"ion-button",7),c.Sb("click",(function(){return c.ic(i),c.Wb().cancelSubscription()})),c.pc(1," Cancel Subscription "),c.oc(2,p,1,0,"ion-spinner",8),c.Jb()}if(2&n){var o=c.Wb();c.Zb("disabled",o.loading),c.xb(2),c.Zb("ngIf",o.cancelLoading)}}function g(n,t){if(1&n){var i=c.Lb();c.Kb(0,"ion-item"),c.Kb(1,"ion-label",12),c.Kb(2,"h2"),c.pc(3),c.Jb(),c.Kb(4,"p"),c.pc(5),c.Jb(),c.Jb(),c.Kb(6,"ion-button",13),c.Sb("click",(function(){c.ic(i);var n=t.$implicit;return c.Wb(2).downloadInvoice(n.id)})),c.pc(7," Download "),c.Jb(),c.Jb()}if(2&n){var o=t.$implicit;c.xb(3),c.rc("Paid ",o.total,""),c.xb(2),c.rc(" ",o.date," ")}}function d(n,t){if(1&n&&(c.Kb(0,"ion-list",10),c.Kb(1,"ion-list-header"),c.pc(2," Invoices "),c.Jb(),c.oc(3,g,8,2,"ion-item",11),c.Jb()),2&n){var i=c.Wb();c.xb(3),c.Zb("ngForOf",i.invoices)}}var v=function(){function n(n,t,i,o,e,r,c){var s=this;this.billingService=n,this.modalController=t,this.alertController=i,this.authenticationService=o,this.iab=e,this.toastController=r,this.storage=c,this.user={},this.authenticationService.getUserData().subscribe((function(n){s.user=n})),this.loading=!0,this.invoices=[],this.getInvoices()}return n.prototype.ngOnInit=function(){},n.prototype.getInvoices=function(){var n=this;this.billingService.getInvoices().then((function(t){n.loading=!1,n.invoices=t}))},n.prototype.downloadInvoice=function(n){var t=this;this.storage.get("go_token").then((function(i){i&&t.iab.create(r.a.apiUrl+"/invoices/"+n+"?token="+i,"_system")}))},n.prototype.cancelSubscription=function(){return Object(o.a)(this,void 0,void 0,(function(){var n=this;return Object(o.c)(this,(function(t){switch(t.label){case 0:return[4,this.alertController.create({header:"Cancel Subscription",message:"Are you sure?",buttons:[{text:"Cancel",role:"cancel",handler:function(){}},{text:"Yes",handler:function(){n.cancelLoading=!0,n.billingService.cancel().then((function(){n.showToast("Subscription Cancelled"),n.getInvoices(),n.authenticationService.getUserData().toPromise().then((function(t){n.user=t}))})).catch((function(t){n.cancelLoading=!1,n.showToast("Failed To Cancel Subscription")}))}}]})];case 1:return[4,t.sent().present()];case 2:return t.sent(),[2]}}))}))},n.prototype.showToast=function(n){return Object(o.a)(this,void 0,void 0,(function(){return Object(o.c)(this,(function(t){switch(t.label){case 0:return[4,this.toastController.create({message:n,duration:4e3})];case 1:return t.sent().present(),[2]}}))}))},n.prototype.formatDate=function(n){return e(n).format("dddd, MMMM Do YYYY")},n.prototype.formatTime=function(n){return e(n).format("h:mma")},n.prototype.dismiss=function(){this.modalController.dismiss()},n.\u0275fac=function(t){return new(t||n)(c.Hb(s.a),c.Hb(a.K),c.Hb(a.a),c.Hb(u.a),c.Hb(b.a),c.Hb(a.R),c.Hb(l.b))},n.\u0275cmp=c.Bb({type:n,selectors:[["app-billing"]],decls:10,vars:2,consts:[["color","primary"],["slot","start"],[3,"click"],["name","close"],[1,"billing"],["color","primary",3,"disabled","click",4,"ngIf"],["class","billing__billing-list",4,"ngIf"],["color","primary",3,"disabled","click"],["color","light","class","billing__cancel-spinner",4,"ngIf"],["color","light",1,"billing__cancel-spinner"],[1,"billing__billing-list"],[4,"ngFor","ngForOf"],[1,"ion-text-wrap"],["slot","end",3,"click"]],template:function(n,t){1&n&&(c.Kb(0,"ion-header"),c.Kb(1,"ion-toolbar",0),c.Kb(2,"ion-buttons",1),c.Kb(3,"ion-button",2),c.Sb("click",(function(){return t.dismiss()})),c.Ib(4,"ion-icon",3),c.Jb(),c.Jb(),c.Kb(5,"ion-title"),c.pc(6,"Billing"),c.Jb(),c.Jb(),c.Jb(),c.Kb(7,"ion-content",4),c.oc(8,h,3,2,"ion-button",5),c.oc(9,d,4,1,"ion-list",6),c.Jb()),2&n&&(c.xb(8),c.Zb("ngIf",t.user.stripe_id&&t.user.subscription&&!t.user.subscription.ends_at),c.xb(1),c.Zb("ngIf",t.invoices&&t.invoices.length>0))},directives:[a.o,a.F,a.h,a.g,a.p,a.E,a.k,f.j,a.C,a.u,a.v,f.i,a.r,a.t],styles:[""]}),n}()},nmdT:function(n,t,i){"use strict";i.r(t),i.d(t,"BillingPageModule",(function(){return l}));var o=i("ofXK"),e=i("3Pt+"),r=i("TEn/"),c=i("tyNb"),s=i("OAiQ"),a=i("fXoL"),u=[{path:"",component:s.a}],b=function(){function n(){}return n.\u0275mod=a.Fb({type:n}),n.\u0275inj=a.Eb({factory:function(t){return new(t||n)},imports:[[c.j.forChild(u)],c.j]}),n}(),l=function(){function n(){}return n.\u0275mod=a.Fb({type:n}),n.\u0275inj=a.Eb({factory:function(t){return new(t||n)},imports:[[o.b,e.b,r.G,b]]}),n}()}}]);